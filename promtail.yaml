server:
  http_listen_port: 9080
  grpc_listen_port: 0

positions:
  filename: /tmp/positions.yaml

clients:
  - url: LOKI_URL_PLACEHOLDER
    batchsize: 50000 # max bytes per batch
    batchwait: 5s # wait before sending batch

# Scrape configs - defines what logs to collect and how to process them
scrape_configs:
  - job_name: juju_status

    static_configs:
      - targets:
          - localhost # Target identifier (not used for file scraping, but required)

        labels:
          job: juju_status # Custom label: job="juju_status"
          juju_environment: JUJU_ENVIRONMENT_PLACEHOLDER
          __path__: /var/log/juju-*.log # File path(s) to tail (supports wildcards)

    # Pipeline stages - optional log processing before sending to Loki
    pipeline_stages:
      - match:
          selector: '{job="juju_status"}' # Only process logs matching this label selector
          stages:
            - regex:
                # Extract fields from log lines using regex named groups
                expression: '^(?P<timestamp>\S+) (?P<level>\w+) (?P<message>.*)'
            - labels:
                level: # Promote the 'level' field to a label for filtering
